"use strict";(self.webpackChunksentinel_docs=self.webpackChunksentinel_docs||[]).push([[1520],{94188:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"javascript","title":"Javascript","description":"With the Javascript SDK, developers can harness the power of Sentinel\'s decentralized network infrastructure to create secure and private communication solutions seamlessly within their JavaScript-based projects.","source":"@site/docs/sdk/javascript.md","sourceDirName":".","slug":"/javascript","permalink":"/sdk/javascript","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"title":"Javascript","sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"Golang","permalink":"/sdk/golang"},"next":{"title":"Python","permalink":"/sdk/python"}}');var i=s(74848),o=s(28453);const r={title:"Javascript",sidebar_position:3},a="Javascript SDK",c={},l=[{value:"Clients",id:"clients",level:2},{value:"Query",id:"query",level:2},{value:"Transaction",id:"transaction",level:2},{value:"Event Parsing",id:"event-parsing",level:2},{value:"Protobuf",id:"protobuf",level:2},{value:"Examples",id:"examples",level:2},{value:"Run Keplr Example",id:"run-keplr-example",level:3},{value:"Run NodeJS Example",id:"run-nodejs-example",level:3}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"javascript-sdk",children:"Javascript SDK"})}),"\n",(0,i.jsx)(n.p,{children:"With the Javascript SDK, developers can harness the power of Sentinel's decentralized network infrastructure to create secure and private communication solutions seamlessly within their JavaScript-based projects."}),"\n",(0,i.jsxs)(n.p,{children:["The Sentinel JavaScript SDK relies on ",(0,i.jsx)(n.a,{href:"https://github.com/cosmos/cosmjs",children:"CosmJS"})," and was developed following the official ",(0,i.jsx)(n.a,{href:"https://tutorials.cosmos.network/tutorials/7-cosmjs/",children:"tutorial"}),". It also draws inspiration from other open-source Cosmos SDK projects."]}),"\n",(0,i.jsx)(n.p,{children:"You can access the Sentinel Javascript SDK from:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/sentinel-official/sentinel-js-sdk",children:"GitHub repository"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://www.npmjs.com/package/@sentinel-official/sentinel-js-sdk",children:"NPMJS Website"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://sentinel-official.github.io/sentinel-js-sdk/",children:"Full Documentation"})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"The SDK exstends the followings:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://cosmos.github.io/cosmjs/latest/stargate/classes/StargateClient.html",children:"@cosmjs/stargate/StargateClient"})," as ",(0,i.jsx)(n.code,{children:"SentinelClient"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://cosmos.github.io/cosmjs/latest/stargate/classes/SigningStargateClient.html",children:"@cosmjs/stargate/SigningStargateClient"})," ",(0,i.jsx)(n.code,{children:"SigningSentinelClient"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://cosmos.github.io/cosmjs/latest/stargate/classes/QueryClient.html",children:"@cosmjs/stargate/QueryClient"})," as ",(0,i.jsx)(n.code,{children:"client.sentinelQuery"})]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"clients",children:"Clients"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'import { SentinelClient } from "@sentinel-official/sentinel-js-sdk";\n\nconst rpc = "https://rpc.sentinel.co:443"\nconst client = await SentinelClient.connect(rpc)\n'})}),"\n",(0,i.jsxs)(n.p,{children:["If you need to sign and broadcast a transaction, you'll need to create an instance of the ",(0,i.jsx)(n.code,{children:"SigningClient"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'import { SigningSentinelClient } from "@sentinel-official/sentinel-js-sdk";\nimport { DirectSecp256k1HdWallet } from "@cosmjs/proto-signing"\nimport { GasPrice } from "@cosmjs/stargate"\n\nconst wallet = await DirectSecp256k1HdWallet.fromMnemonic(mnemonic, { prefix: "sent" });\nconst [account] = await wallet.getAccounts();\n\nconst rpc = "https://rpc.sentinel.co:443"\n\n// With a default GasPrice:\nconst customDenom = "udvpn"\nconst gasPrice = GasPrice.fromString(`0.2${customDenom}`);\nconst client = await SigningSentinelClient.connectWithSigner(rpc, wallet, {\n    gasPrice: gasPrice\n})\n\n// Without a default GasPrice:\nconst client = await SigningSentinelClient.connectWithSigner(rpc, wallet)\n'})}),"\n",(0,i.jsxs)(n.p,{children:["You can also configure additional default parameters here: ",(0,i.jsx)(n.a,{href:"https://cosmos.github.io/cosmjs/latest/stargate/interfaces/SigningStargateClientOptions.html",children:"SigningStargateClientOptions"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"To subscribe to chain events, you'll require a WebSocket client."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'import { SentinelWsClient } from "@sentinel-official/sentinel-js-sdk";\nconst client = new SentinelWsClient("wss://rpc.sentinel.quokkastake.io");\nconst stream = client.subscribe("tm.event=\'NewBlock\'")\nstream.addListener({\n    next: data => console.log(data),\n    error: err => console.error(err),\n    complete: () => console.log(\'completed\'),\n});\n'})}),"\n",(0,i.jsx)(n.h2,{id:"query",children:"Query"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'import { Status, PageRequest } from "@sentinel-official/sentinel-js-sdk";\nconst nodes = await client.sentinelQuery?.node.nodes(\n    Status.STATUS_ACTIVE,\n    PageRequest.fromPartial({\n        limit: 5,\n        countTotal: true\n    })\n)\n'})}),"\n",(0,i.jsx)(n.p,{children:"For pagination guidance, refer to the following links:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://docs.cosmos.network/v0.45/core/proto-docs.html#cosmos-base-query-v1beta1-pagination-proto",children:"https://docs.cosmos.network/v0.45/core/proto-docs.html#cosmos-base-query-v1beta1-pagination-proto"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/cosmos/cosmos-sdk/blob/main/types/query/pagination.pb.go#L32-L53",children:"https://github.com/cosmos/cosmos-sdk/blob/main/types/query/pagination.pb.go#L32-L53"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/confio/cosmjs-types/blob/main/src/cosmos/base/query/v1beta1/pagination.ts",children:"https://github.com/confio/cosmjs-types/blob/main/src/cosmos/base/query/v1beta1/pagination.ts"})}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"transaction",children:"Transaction"}),"\n",(0,i.jsxs)(n.p,{children:["Once you've initialized a ",(0,i.jsx)(n.code,{children:"SigningClient"}),", you have several options for preparing and broadcasting a transaction:"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["You can create a ",(0,i.jsx)(n.code,{children:"MsgEcodeObject"})," and then use the ",(0,i.jsx)(n.code,{children:"signAndBroadcast"})," method from your client to handle the transaction."]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'import { TxNodeSubscribe, nodeSubscribe } from "@sentinel-official/sentinel-js-sdk";\nimport Long from "long";\n\nconst args: TxNodeSubscribe = {\n    from: account.address,\n    nodeAddress: sentnode,\n    gigabytes: Long.fromNumber(gigabytes, true),\n    denom: "udvpn"\n}\nconst msg = nodeSubscribe(args)\nconst tx = client.signAndBroadcast(account.address, [msg], "auto", "memo")\n'})}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsxs)(n.li,{children:["Alternatively, you can directly call ",(0,i.jsx)(n.code,{children:"nodeSubscribe"})," from your client or from a submodule. This method will automatically handle signing and broadcasting the transaction for you."]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'import { TxNodeSubscribe } from "@sentinel-official/sentinel-js-sdk";\nimport Long from "long";\n\nconst args: TxNodeSubscribe = {\n    from: account.address,\n    nodeAddress: sentnode,\n    gigabytes: Long.fromNumber(gigabytes, true),\n    denom: "udvpn",\n    fee: "auto",\n    memo: "hello from js-sdk"\n}\n// call directly\nconst tx1 = client.nodeSubscribe(args)\n// use submodule\nconst tx2 = client.node.subscribe(args)\n'})}),"\n",(0,i.jsxs)(n.p,{children:["It is up to you if you want to ",(0,i.jsx)(n.code,{children:"await"})," the tx or use a callback."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"const tx1 = await client.nodeSubscribe(args)\nclient.nodeSubscribe(args).then(tx => { do stuff... })\n"})}),"\n",(0,i.jsx)(n.h2,{id:"event-parsing",children:"Event Parsing"}),"\n",(0,i.jsxs)(n.p,{children:["When dealing with event parsing, whether through ",(0,i.jsx)(n.code,{children:"client.signAndBroadcast"})," or implicitly via methods like ",(0,i.jsx)(n.code,{children:"client.nodeSubscribe"})," or ",(0,i.jsx)(n.code,{children:"client.node.subscribe"}),", you'll receive a ",(0,i.jsx)(n.code,{children:"DeliverTxResponse"}),". To find a specific event, you can utilize the ",(0,i.jsx)(n.code,{children:"searchEvent"})," method. For instance, if you're searching for s",(0,i.jsx)(n.code,{children:"entinel.node.v2.EventCreateSubscription"}),", you can proceed as follows:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'import { searchEvent } from "@sentinel-official/sentinel-js-sdk";\nconst eventCreateSubscription = searchEvent(sentinel.node.v2.EventCreateSubscription, tx.events);\n'})}),"\n",(0,i.jsx)(n.p,{children:"Or for a more refined approach:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'import { searchEvent } from "@sentinel-official/sentinel-js-sdk";\nimport { NodeEventCreateSubscription } from "@sentinel-official/sentinel-js-sdk";\nconst eventCreateSubscription = searchEvent(NodeEventCreateSubscription.type, tx.events);\n'})}),"\n",(0,i.jsx)(n.p,{children:"You can also parse a single event using the appropriate interface, as demonstrated below:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'import { searchEvent } from "@sentinel-official/sentinel-js-sdk";\nimport { NodeEventCreateSubscription, isNodeEventCreateSubscription } from "@sentinel-official/sentinel-js-sdk";\n\nconst eventCreateSubscription = searchEvent(NodeEventCreateSubscription.type, tx.events);\nif(eventCreateSubscription && isNodeEventCreateSubscription(eventCreateSubscription)) {\n    const eventParsed = NodeEventCreateSubscription.parse(eventCreateSubscription)\n    console.log(`Your subscription id is: ${eventParsed.value.id}`)\n} else console.log("eventCreateSubscription, not found")\n'})}),"\n",(0,i.jsx)(n.h2,{id:"protobuf",children:"Protobuf"}),"\n",(0,i.jsxs)(n.p,{children:["We compile all the .proto files using ",(0,i.jsx)(n.a,{href:"https://grpc.io/docs/protoc-installation/",children:"protoc"})," with ",(0,i.jsx)(n.a,{href:"https://github.com/stephenh/ts-proto",children:"ts-proto"})," as a plugin. The resulting ",(0,i.jsx)(n.code,{children:".ts"})," proto files can be found in the ",(0,i.jsx)(n.code,{children:"src/protobuf"})," directory. If you need to compile them again, you can simply run the ",(0,i.jsx)(n.a,{href:"https://github.com/sentinel-official/sentinel-js-sdk/blob/main/scripts/generate-proto.sh",children:"scripts/generate-proto.sh"}),". This script needs ",(0,i.jsx)(n.code,{children:"git"})," and ",(0,i.jsx)(n.code,{children:"protoc"})," to be installed, and it will handle downloading all the .proto definitions from ",(0,i.jsx)(n.a,{href:"https://github.com/sentinel-official/hub/tree/development/proto/sentinel",children:"Sentinel Hub"})," and other related third-party sources automatically."]}),"\n",(0,i.jsx)(n.h2,{id:"examples",children:"Examples"}),"\n",(0,i.jsxs)(n.p,{children:["You can also use the official ",(0,i.jsx)(n.a,{href:"https://gist.github.com/webmaster128/8444d42a7eceeda2544c8a59fbd7e1d9",children:"cosmjs examples"}),". Just make sure to swap out ",(0,i.jsx)(n.code,{children:"StargateClient"})," with ",(0,i.jsx)(n.code,{children:"SentinelClient"})," and ",(0,i.jsx)(n.code,{children:"SigningStargateClient"})," with ",(0,i.jsx)(n.code,{children:"SigningSentinelClient"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["Currently, the repository provides a ",(0,i.jsx)(n.code,{children:"Node.js"})," script example and one for ",(0,i.jsx)(n.code,{children:"Keplr"})," (based on: ",(0,i.jsx)(n.a,{href:"https://tutorials.cosmos.network/tutorials/7-cosmjs/4-with-keplr.html",children:"https://tutorials.cosmos.network/tutorials/7-cosmjs/4-with-keplr.html"}),")."]}),"\n",(0,i.jsx)(n.p,{children:'If you prefer to use a local version of the SDK for testing purposes, you\'ll need to compile the "src" folder into "dist" and then link the package with npm.'}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"npm run build\nnpm link\ncd examples/<choose-an-example>\nnpm link @sentinel-official/sentinel-js-sdk\n"})}),"\n",(0,i.jsx)(n.h3,{id:"run-keplr-example",children:"Run Keplr Example"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd examples/keplr\nnpm i\nnpm run dev\n"})}),"\n",(0,i.jsx)(n.h3,{id:"run-nodejs-example",children:"Run NodeJS Example"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd examples/node\nnpm i\nts-node main.ts\n"})})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>r,x:()=>a});var t=s(96540);const i={},o=t.createContext(i);function r(e){const n=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);