"use strict";(self.webpackChunksentinel_docs=self.webpackChunksentinel_docs||[]).push([[9061],{74201:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>d,frontMatter:()=>l,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"ibc-relayers/restoring-ibc-channel","title":"Restoring IBC Channel","description":"IBC channels rely on client states to maintain synchronization. If no transactions are relayed for an extended period, the client state may expire due to inactivity or configuration parameters like trustingperiod and maxclock_drift. Once expired, the channel becomes non-functional and requires restoration through governance processes.","source":"@site/docs/full-node-setup/ibc-relayers/restoring-ibc-channel.md","sourceDirName":"ibc-relayers","slug":"/ibc-relayers/restoring-ibc-channel","permalink":"/full-node-setup/ibc-relayers/restoring-ibc-channel","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":13,"frontMatter":{"title":"Restoring IBC Channel","sidebar_position":13},"sidebar":"tutorialSidebar","previous":{"title":"List","permalink":"/full-node-setup/ibc-relayers/relayers-list"}}');var s=t(74848),r=t(28453);const l={title:"Restoring IBC Channel",sidebar_position:13},c="Restoring IBC Channel",a={},o=[{value:"Requirements",id:"requirements",level:2},{value:"Informations Needed",id:"informations-needed",level:2},{value:"Step-by-Step Process",id:"step-by-step-process",level:2},{value:"Query the Existing Client",id:"query-the-existing-client",level:3},{value:"Create a New Client",id:"create-a-new-client",level:3},{value:"Verify the New Client",id:"verify-the-new-client",level:3},{value:"Handle Configuration Issues",id:"handle-configuration-issues",level:3},{value:"Submit a Governance Proposal",id:"submit-a-governance-proposal",level:3},{value:"Final Steps",id:"final-steps",level:3}];function h(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"restoring-ibc-channel",children:"Restoring IBC Channel"})}),"\n",(0,s.jsxs)(n.p,{children:["IBC channels rely on client states to maintain synchronization. If no transactions are relayed for an extended period, the client state may expire due to inactivity or configuration parameters like ",(0,s.jsx)(n.code,{children:"trusting_period"})," and ",(0,s.jsx)(n.code,{children:"max_clock_drift"}),". Once expired, the channel becomes non-functional and requires restoration through governance processes."]}),"\n",(0,s.jsx)(n.h2,{id:"requirements",children:"Requirements"}),"\n",(0,s.jsx)(n.p,{children:"Ensure Hermes is configured and working."}),"\n",(0,s.jsx)(n.h2,{id:"informations-needed",children:"Informations Needed"}),"\n",(0,s.jsxs)(n.p,{children:["To restore the IBC channel, we need the client ID, connection ID, and channel ID. These can be found here ",(0,s.jsx)(n.a,{href:"https://ping.pub/sentinel/ibc/connection/connection-33",children:"https://ping.pub/sentinel/ibc/connection/connection-33"})]}),"\n",(0,s.jsx)(n.p,{children:"For example:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["clientId = ",(0,s.jsx)(n.code,{children:"07-tendermint-58"})]}),"\n",(0,s.jsxs)(n.li,{children:["connectionId = ",(0,s.jsx)(n.code,{children:"connection-33"})]}),"\n",(0,s.jsxs)(n.li,{children:["channel-id = ",(0,s.jsx)(n.code,{children:"channel-12"})]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"step-by-step-process",children:"Step-by-Step Process"}),"\n",(0,s.jsx)(n.p,{children:"On sentinelhub-2, the client 07-tendermint-58 has expired because no relayers refreshed it. To fix this, we need to:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Create a new client."}),"\n",(0,s.jsx)(n.li,{children:"Submit a governance proposal to update the expired client."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:'Note: While the proposal is for "replacing" the client, the old client will actually be updated.'}),"\n",(0,s.jsx)(n.h3,{id:"query-the-existing-client",children:"Query the Existing Client"}),"\n",(0,s.jsx)(n.p,{children:"Use the following command to check the state of the old client and save the output:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"hermes query client state --chain sentinelhub-2 --client 07-tendermint-58\n"})}),"\n",(0,s.jsx)(n.h3,{id:"create-a-new-client",children:"Create a New Client"}),"\n",(0,s.jsxs)(n.p,{children:["Create a new client between the chains. Save the newly created client ID from the output (e.g., ",(0,s.jsx)(n.code,{children:"07-tendermint-208"}),"):"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"hermes create client --host-chain sentinelhub-2 --reference-chain cosmoshub-4\n"})}),"\n",(0,s.jsx)(n.h3,{id:"verify-the-new-client",children:"Verify the New Client"}),"\n",(0,s.jsx)(n.p,{children:"Query the new client to ensure it's correctly configured and save the output:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"hermes query client state --chain sentinelhub-2 --client 07-tendermint-208\n"})}),"\n",(0,s.jsx)(n.p,{children:"Compare the outputs of the old and new clients to verify they are identical."}),"\n",(0,s.jsx)(n.h3,{id:"handle-configuration-issues",children:"Handle Configuration Issues"}),"\n",(0,s.jsxs)(n.p,{children:["If the new client has a different max clock drift (or other mismatched parameters), creating the proposal may fail. For example:\n",(0,s.jsx)(n.a,{href:"https://www.mintscan.io/sentinel/tx/09BC809FE229DAB0458EBFAD9F48A7DD26F26C7FC958ABC1274CAE1FDA314DFB?height=19809320",children:"Failed Proposal Example"})]}),"\n",(0,s.jsxs)(n.p,{children:["To fix this, create a new client with a custom ",(0,s.jsx)(n.code,{children:"max clock drift"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"hermes create client --host-chain sentinelhub-2 --reference-chain cosmoshub-4 --clock-drift 1800s\n"})}),"\n",(0,s.jsx)(n.p,{children:"Query and verify the new client again:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"hermes query client state --chain sentinelhub-2 --client 07-tendermint-209\n"})}),"\n",(0,s.jsx)(n.h3,{id:"submit-a-governance-proposal",children:"Submit a Governance Proposal"}),"\n",(0,s.jsxs)(n.p,{children:["Once the new client matches the old one, submit a governance proposal to update the client.\nRun this command on a server with ",(0,s.jsx)(n.code,{children:"sentinelhub"})," installed (not the one running Hermes):"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"sentinelhub tx gov submit-proposal update-client 07-tendermint-58 07-tendermint-209 --chain-id sentinelhub-2 --from validator --fees 200000udvpn --gas 2000000 --title 'Reviving DVPN <-> ATOM IBC channel' --description 'Currently, the DVPN <-> ATOM IBC channel has its client expired on Sentinel side, which blocks relaying. To fix that, we need to replace the client with the newly created one that is not expired.\\n\\nPlease vote YES if you agree with restoring IBC channel between Cosmos Hub and Sentinel.' --deposit 1000000udvpn\n"})}),"\n",(0,s.jsx)(n.h3,{id:"final-steps",children:"Final Steps"}),"\n",(0,s.jsx)(n.p,{children:"The proposal is now submitted with a 1 DVPN deposit. Next:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Put the proposal to a vote."}),"\n",(0,s.jsx)(n.li,{children:"Ensure it passes to restore the IBC channel."}),"\n"]})]})}function d(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>l,x:()=>c});var i=t(96540);const s={},r=i.createContext(s);function l(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);